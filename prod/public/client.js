function setState(a){"o"==doors[a.id].st?(a.classList.add("ctrlBtn_opened"),a.classList.remove("ctrlBtn_closed"),a.textContent="O"):(a.classList.add("ctrlBtn_closed"),a.classList.remove("ctrlBtn_opened"),a.textContent="X"),doors[a.id].cd>0?a.setAttribute("disabled","true"):a.removeAttribute("disabled")}function doorAction(a){socket.emit("door",JSON.stringify({id:a.id,s:doors[a.id].st}))}var doors={},buttons={},socket=io();setInterval(function(){socket.emit("allDoors",""),console.log("allDoors"),socket.on("allDoors",function(a){doors=JSON.parse(a);for(id in doors)setState(buttons[id])})},1e4),window.onload=function(){socket.emit("labirint_setup",""),socket.on("labirint_setup",function(a){doors=JSON.parse(a);for(var b in doors){var c=document.createElement("button");c.className="ctrlBtn",c.id=b,c.onclick=function(){doorAction(this)},controlButtons.appendChild(c)}for(var d=controlButtons.getElementsByClassName("ctrlBtn"),e=0;e<d.length;++e)buttons[d[e].id]=d[e],setState(buttons[d[e].id])})},socket.on("door",function(a){var b=JSON.parse(a);doors[b.id]=b.data,setState(buttons[b.id])});